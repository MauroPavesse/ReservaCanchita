@page
@model ReservaCanchita.Pages.Administrador.ConfiguracionModel
@{
    ViewData["Title"] = "Configuracion";
}

<h2>Configuración</h2>

<form method="post">
    <div>
        <label>Nombre de la empresa:</label>
        <input asp-for="NombreEmpresa" class="form-control" />
    </div>

    <div>
        <label>Número de contacto:</label>
        <input asp-for="NumeroContacto" class="form-control" />
    </div>

    <div>
        <label>
            <input type="checkbox" asp-for="MuestraValorReserva" id="reservaCheckbox" />
            Mostrar importe de reserva
        </label>
        <input asp-for="ValorReserva" class="form-control w-25" id="reservaInput" type="number" min="0" />
    </div>

    <div>
        <label>
            <input type="checkbox" asp-for="TrabajaConToleranciaCancelarReserva" id="numeroExtraCheckbox" />
            Trabaja con horas de tolerancia al cancelar turno
        </label>
        <input asp-for="HoraToleranciaCancelarReserva" class="form-control w-25" id="numeroExtraInput" type="number" min="0" />
    </div>

    @if (@Model.VersionWhatsApp)
    {
        <div>
            <label>
                <input type="checkbox" asp-for="TrabajaConWhatsApp" id="whatsAppCheckbox" />
                Trabaja con WhatsApp
            </label>
        </div>
    }

    @if (@Model.VersionMenuComidas)
    {
        <div>
            <label>
                <input type="checkbox" asp-for="TrabajaConMenuComidas" id="menuComidasCheckbox" />
                Trabaja con Menu de Comidas
            </label>
        </div>
    }

    @if (@Model.VersionIncluyeMercadoPago)
    {
        <div style="border: solid; border-radius: 10px; padding: 10px; margin-top: 5px">
            <div>
                <label>
                    <input type="checkbox" asp-for="TrabajaConSena" id="trabajaConSenaCheckbox" />
                    Trabaja con Seña
                </label>
            </div>
            <label>Token de Mercado Pago:</label>
            <input asp-for="AccessTokenMercadoPago" class="form-control" id="accessTokenMercadoPagoInput" type="text" />
            <label>Alias de Mercado Pago:</label>
            <input asp-for="AliasMercadoPago" class="form-control" id="aliasMercadoPagoInput" type="text" />
        </div>
    }

    <button type="submit" class="btn btn-primary mt-2">Guardar configuración</button>
</form>

@section Scripts {
    <script>
        function toggleInput(checkboxId, inputId) {
            const checkbox = document.getElementById(checkboxId);
            const input = document.getElementById(inputId);

            if (!checkbox || !input) return; // Si no existen, no hacer nada

            input.disabled = !checkbox.checked;
        }

        // Función para agregar eventos de forma segura
        function attachToggle(checkboxId, inputIds) {
            const checkbox = document.getElementById(checkboxId);
            if (!checkbox) return;

            checkbox.addEventListener("change", () => {
                inputIds.forEach(id => toggleInput(checkboxId, id));
            });

            // Inicializar estado
            inputIds.forEach(id => toggleInput(checkboxId, id));
        }

        // Solo estos checkboxes tienen inputs asociados:
        attachToggle("reservaCheckbox", ["reservaInput"]);
        attachToggle("numeroExtraCheckbox", ["numeroExtraInput"]);
        attachToggle("trabajaConSenaCheckbox", ["accessTokenMercadoPagoInput", "aliasMercadoPagoInput"]);
    </script>
}


